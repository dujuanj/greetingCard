<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/common.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
 <style>
       .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            transition: opacity 0.5s ease; /* 添加平滑的过渡效果 */
        }
        #downloadImage {
            display: none; /* 初始隐藏图片 */
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
     <div class="container result_wrap" id="captureArea">
        <div class="card_wrap">
          
            <p id="nameDisplay"></p>
            <span id="yearDisplay"></span>
            <span id="monthDisplay"></span>
            <span id="dayDisplay"></span>
            <p id="daysDisplay"></p>
            <p id="dateDisplay"></p>
        </div>
    </div>
     <img id="downloadImage" alt="点击生成的图片" />
    <script>
        // 页面加载时，设置 sessionStorage 的值
        document.addEventListener("DOMContentLoaded", function() {

            // 从 sessionStorage 中获取并显示值
            const storedName = sessionStorage.getItem('name');
            const storedDate = sessionStorage.getItem('date');

            // 显示获取的值到页面上
            document.getElementById("nameDisplay").textContent = storedName;
           // 将存储的日期字符串（如 2024-09-19）分成年、月、日
            const dateParts = storedDate.split('-'); // 分割日期为 ["2024", "09", "19"]

            const year = dateParts[0];
            const month = dateParts[1];
            const day = dateParts[2];

            // 显示年、月、日到对应的 HTML 元素
            document.getElementById("yearDisplay").textContent = year;
            document.getElementById("monthDisplay").textContent = month;
            document.getElementById("dayDisplay").textContent = day;

             // 计算存储的日期与当前日期的差值
            const selectedDate = new Date(storedDate);
            const currentDate = new Date();

            // 计算两者的时间差 (毫秒)
            const timeDifference = currentDate - selectedDate;

            // 将时间差转为天数
            const daysDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

            // 显示天数
            document.getElementById("daysDisplay").textContent = `${daysDifference}`;
            
            const captureArea = document.getElementById('captureArea');
            captureArea.addEventListener('touchstart', handleLongPress);
        });
        let timeout;

        // 处理长按事件
        function handleLongPress(e) {
            e.preventDefault();
            timeout = setTimeout(() => {
                // 用户长按超过设定时间后生成图片
                convertToImage();
            }, 800); // 800毫秒内未松开则触发长按事件
        }

        // 清除长按事件
        document.addEventListener('touchend', function() {
            clearTimeout(timeout);
        });

        // 使用 html2canvas 将页面内容转换为图片
        function convertToImage() {
            const captureArea = document.getElementById('captureArea');  // 获取需要截图的区域
            const imgElement = document.getElementById('downloadImage');

            html2canvas(captureArea).then(function(canvas) {
                // 生成图片
                imgElement.src = canvas.toDataURL('image/png');
                imgElement.style.display = 'block';  // 显示生成的图片

                // 使用 CSS 过渡效果来隐藏原始内容，显示图片
                captureArea.style.opacity = 0;  // 逐渐隐藏原始内容
                setTimeout(() => {
                    captureArea.style.display = 'none';  // 完全隐藏
                }, 500);  // 延迟500ms与过渡动画同步

                // 显示图片
                imgElement.style.opacity = 1;
            });
        }
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* 页面内容和图片显示时保持居中 */
        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #downloadImage {
            display: none; /* 图片在生成前不可见 */
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
     <div class="container result_wrap" id="captureArea">
        <div class="card_wrap">
            <p id="nameDisplay">名字：张三</p>
            <span id="yearDisplay">2024</span>年
            <span id="monthDisplay">09</span>月
            <span id="dayDisplay">19</span>日
            <p id="daysDisplay">100天</p> <!-- 用于显示天数 -->
        </div>
     </div>
     <img id="downloadImage" alt="点击生成的图片" />

    <script>
        let timeout;

        // 页面加载时，自动生成图片
        document.addEventListener("DOMContentLoaded", function() {
            const captureArea = document.getElementById('captureArea');
            const imgElement = document.getElementById('downloadImage');

            // 使用 html2canvas 生成图片
            html2canvas(captureArea).then(function(canvas) {
                // 将生成的图片设置到 img 标签中
                imgElement.src = canvas.toDataURL('image/png');
            });

            // 添加长按事件监听器（捕获用户长按事件）
            captureArea.addEventListener('touchstart', handleLongPress);
        });

        // 处理长按事件
        function handleLongPress(e) {
            e.preventDefault();
            timeout = setTimeout(() => {
                // 长按800ms后显示图片
                document.getElementById('downloadImage').style.display = 'block';
                alert('现在可以长按保存图片！');  // 提示用户可以长按保存
            }, 800);  // 长按800毫秒触发图片显示
        }

        // 清除长按事件
        document.addEventListener('touchend', function() {
            clearTimeout(timeout);
        });
    </script>
</body>
</html>
